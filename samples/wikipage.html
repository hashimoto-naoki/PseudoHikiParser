<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
  "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en">
<head>
<meta content="en" http-equiv="Content-Language">
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
<meta content="text/javascript" http-equiv="Content-Script-Type">
<title>A sample of PseudoHikiParser</title>
<link href="css/default.css" rel="stylesheet" type="text/css">
</head>
<body>
<div class="section h1">
<h1>Welcome to the PseudoHikiParser wiki!
</h1>
<div class="section h2">
<h2 id="ABOUT"> About PseudoHikiParser
</h2>
<p>
PseudoHikiParser is a converter of texts written in a <a href="https://github.com/hiki/hikidoc">Hiki</a> like notation, into HTML, Markdown or other formats.
</p>
<p>
I am writing this tool with following objectives in mind,
</p>
<ul>
<li> provide some additional features that do not exist in the original Hiki notation
<ul>
<li> make the notation more line oriented

<li> allow to assign ids to elements such as headings

</ul>

<li> support several formats other than HTML
<ul>
<li> The visitor pattern is adopted for the implementation, so you only have to add a visitor class to support a certain format.

</ul>

</ul>
<p>
And, it would not be compatible with the original Hiki notation.
</p>
<!-- end of section h2 -->
</div>
<div class="section h2">
<h2 id="LICENSE"> License
</h2>
<p>
BSD 2-Clause License
</p>
<p>
<del>I haven't yet decided the terms and conditions for the reuse and redistribution, but consider adopting a dual-licensed style. </del>
</p>
<p>
<del>And one of them will be BSD 2-clause license or MIT license.</del>
</p>
<p>
(It seems bothersome for me to manage a dual-licensed script.)
</p>
<!-- end of section h2 -->
</div>
<div class="section h2">
<h2 id="INSTALLATION"> Installation
</h2>
<pre>
gem install pseudohikiparser
</pre>
<p>
or if you also want to try out experimental features,
</p>
<pre>
gem install pseudohikiparser --pre
</pre>
<!-- end of section h2 -->
</div>
<div class="section h2">
<h2 id="USAGE"> Usage
</h2>
<div class="section h3">
<h3 id="SAMPLES"> Samples
</h3>
<ul>
<li><a href="https://github.com/nico-hn/PseudoHikiParser/blob/develop/samples/wikipage.txt">A sample text</a> in Hiki notation

</ul>
<p>
And results of conversion
</p>
<ul>
<li><a href="http://htmlpreview.github.com/?https://github.com/nico-hn/PseudoHikiParser/blob/develop/samples/wikipage.html">HTML 4.01</a>

<li><a href="http://htmlpreview.github.com/?https://github.com/nico-hn/PseudoHikiParser/blob/develop/samples/wikipage_with_toc.html">XHTML 1.0</a>

<li><a href="http://htmlpreview.github.com/?https://github.com/nico-hn/PseudoHikiParser/blob/develop/samples/wikipage_html5_with_toc.html">HTML5</a>

<li><a href="https://github.com/nico-hn/PseudoHikiParser/blob/develop/samples/wikipage.md">GFM</a>

</ul>
<p>
You will find these samples in <a href="https://github.com/nico-hn/PseudoHikiParser/tree/develop/samples">develop branch</a>.
</p>
<!-- end of section h3 -->
</div>
<div class="section h3">
<h3 id="PSEUDOHIKI2HTML"> pseudohiki2html.rb
</h3>
<p>
<em>(Please note that pseudohiki2html.rb is currently provided as a showcase of PseudoHikiParser, and the options will be continuously changed at this stage of development.)</em>
</p>
<p>
After the installation of PseudoHikiParser, you can use a command: <strong>pseudohiki2html.rb</strong>.
</p>
<p>
Type the following lines at the command prompt:
</p>
<pre>
pseudohiki2html.rb &lt;&lt;TEXT
!! The first heading
The first paragraph
TEXT
</pre>
<p>
And it will return the following result to stdout:
</p>
<pre>
&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;
  &quot;<a href="http://www.w3.org/TR/html4/loose.dtd&amp;quot;&amp;gt;">http://www.w3.org/TR/html4/loose.dtd&quot;&gt;</a>
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
&lt;meta content=&quot;en&quot; http-equiv=&quot;Content-Language&quot;&gt;
&lt;meta content=&quot;text/html; charset=UTF-8&quot; http-equiv=&quot;Content-Type&quot;&gt;
&lt;meta content=&quot;text/javascript&quot; http-equiv=&quot;Content-Script-Type&quot;&gt;
&lt;title&gt;-&lt;/title&gt;
&lt;link href=&quot;default.css&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot;&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;div class=&quot;section h2&quot;&gt;
&lt;h2&gt; The first heading
&lt;/h2&gt;
&lt;p&gt;
The first paragraph
&lt;/p&gt;
&lt;!-- end of section h2 --&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</pre>
<p>
And if you specify a file name with <code>--output</code> option:
</p>
<pre>
pseudohiki2html.rb --output first_example.html &lt;&lt;TEXT
!! The first heading
The first paragraph
TEXT
</pre>
<p>
the result will be saved in first_example.html.
</p>
<p>
For more options, please try <code>pseudohiki2html.rb --help</code>
</p>
<div class="section h4">
<h4> Incompatible changes
</h4>
<p>
From version 0.0.0.9.develop, command line options are renamed as follows:
</p>
<table>
<tr><th>old name</th><th>new name</th><th>note
</th></tr>
<tr><td>-f</td><td>-F</td><td>'-f' is now used as the short version of '--format-version'
</td></tr>
<tr><td>-h</td><td>-f</td><td>'-h' is now used as the short version of '--help'
</td></tr>
<tr><td>--html_version</td><td>--format-version</td><td>other formats than html should be supported
</td></tr>
<tr><td>--encoding</td><td>--format-encoding</td><td>'--encoding' is now used as the long version of '-E' option
</td></tr>
<tr><td>-</td><td>--encoding</td><td>now same as '-E' option of MRI
</td></tr>
</table>
<!-- end of section h4 -->
</div>
<!-- end of section h3 -->
</div>
<div class="section h3">
<h3 id="PSEUDOHIKI_BLOCKPARSER"> class PseudoHiki::BlockParser
</h3>
<p>
A class method PseudoHiki::BlockParser.parse composes a syntax tree from its input, and a visitor class converts the tree into a certain format.
</p>
<p>
If you save the lines below as a ruby script and execute it:
</p>
<pre>
#!/usr/bin/env ruby

require 'pseudohikiparser'

hiki_text = &lt;&lt;TEXT
!! The first heading
The first paragraph
TEXT

tree = PseudoHiki::BlockParser.parse(hiki_text)
html = PseudoHiki::HtmlFormat.format(tree)
puts html
</pre>
<p>
you will get the following output:
</p>
<pre>
&lt;div class=&quot;section h2&quot;&gt;
&lt;h2&gt; The first heading
&lt;/h2&gt;
&lt;p&gt;
The first paragraph
&lt;/p&gt;
&lt;!-- end of section h2 --&gt;
&lt;/div&gt;
</pre>
<p>
In the example above, HtmlFormat is a visitor class that converts the parsed text into HTML 4.01 format.
</p>
<p>
Other than HtmlFormat, XhtmlFormat, Xhtml5Format, PlainTextFormat and MarkDownFormat are available.
</p>
<div class="section h4">
<h4 id="WIKI_NAMES"> WikiNames
</h4>
<p>
If you want to use WikiNames, you have to pass an instance of PseudoHiki::AutoLink::<a href="https://github.com/nico-hn/PseudoHikiParser/blob/develop/lib/pseudohiki/autolink.rb#L11">WikiName</a> as the argument of BlockParser.new or the second argument of BlockParser.parse.
</p>
<pre>
require 'pseudohiki/blockparser'
require 'pseudohiki/htmlformat'
require 'pseudohiki/autolink' # PseudoHiki::AutoLink::WikiName is defined in this file.

text = &lt;&lt;TEXT
a line with an ^EscapedWikiName and a WikiName.
TEXT

puts &quot;--- with default options:&quot;
wiki_name_link = PseudoHiki::AutoLink::WikiName.new
tree = PseudoHiki::BlockParser.parse(text, wiki_name_link)
puts PseudoHiki::XhtmlFormat.format(tree)

puts &quot;--- when :escape_wiki_name option is set to true:&quot;
escape_wiki_name_link = PseudoHiki::AutoLink::WikiName.new({:escape_wiki_name =&gt; true})
escaped_tree = PseudoHiki::BlockParser.parse(text, escape_wiki_name_link)
puts PseudoHiki::XhtmlFormat.format(escaped_tree)
</pre>
<p>
will print
</p>
<pre>
--- with default options:
&lt;p&gt;
a line with an ^&lt;a href=&quot;EscapedWikiName&quot;&gt;EscapedWikiName&lt;/a&gt; and a &lt;a href=&quot;WikiName&quot;&gt;WikiName&lt;/a&gt;.
&lt;/p&gt;
--- when :escape_wiki_name option is set to true:
&lt;p&gt;
a line with an EscapedWikiName and a &lt;a href=&quot;WikiName&quot;&gt;WikiName&lt;/a&gt;.
&lt;/p&gt;
</pre>
<p>
And if you don't like the default behavior, you may prepare a class/module that substitutes AutoLink::<a href="https://github.com/nico-hn/PseudoHikiParser/blob/develop/lib/pseudohiki/autolink.rb#L11">WikiName</a>.
</p>
<!-- end of section h4 -->
</div>
<!-- end of section h3 -->
</div>
<div class="section h3">
<h3 id="PSEUDOHIKI_FORMAT"> class PseudoHiki::Format
</h3>
<p>
If you don't need to reuse a tree parsed by PseudoHiki::BlockParser.parse, you can use following class methods of PseudoHiki::Format.
</p>
<table>
<tr><th>Method name</th><th>Result of conversion
</th></tr>
<tr><td>to_html</td><td>HTML 4.01
</td></tr>
<tr><td>to_xhtml</td><td>XHTML 1.0
</td></tr>
<tr><td>to_html5</td><td>HTML 5
</td></tr>
<tr><td>to_plain</td><td>plain text
</td></tr>
<tr><td>to_markdown</td><td>Markdown
</td></tr>
<tr><td>to_gfm</td><td>Github Flavored Markdown
</td></tr>
</table>
<p>
For example, the script below returns the same result as the example of <a href="#PSEUDOHIKI_BLOCKPARSER">PseudoHiki::BlockParser</a>
</p>
<pre>
#!/usr/bin/env ruby

require 'pseudohikiparser'

hiki_text = &lt;&lt;TEXT
!! The first heading
The first paragraph
TEXT

puts PseudoHiki::Format.to_html(hiki_text)
</pre>
<!-- end of section h3 -->
</div>
<!-- end of section h2 -->
</div>
<div class="section h2">
<h2 id="DEVELEPMENT_STATUS"> Development status of features from the original <a href="https://github.com/hiki/hikidoc/blob/master/TextFormattingRules.md">Hiki notation</a>
</h2>
<ul>
<li> Paragraphs - Usable

<li> Links
<ul>
<li> WikiNames - <del>Not supported (and would never be)</del> Provided as an option but not tested well

<li> Linking to other Wiki pages - Not supported

<li> Linking to an arbitrary URL - Maybe usable

</ul>

<li> Preformatted text - Usable

<li> Text decoration - Partly supported
<ul>
<li> Means of escaping tags for inline decorations is just experimetal.

<li> The notation for inline literals by backquote tags(``) is converted into not &lt;tt&gt; element but &lt;code&gt; element.

</ul>

<li> Headings - Usable

<li> Horizontal lines - Usable

<li> Lists - Usable

<li> Quotations - Usable

<li> Definitions - Usable

<li> Tables - Usable

<li> Comments - Usable

<li> Plugins - Not supported (and will not be compatible with the original one)

</ul>
<!-- end of section h2 -->
</div>
<div class="section h2">
<h2 id="ADDITIONAL_FEATURES"> Additional Features
</h2>
<div class="section h3">
<h3 id="ASSIGNING_IDS"> Assigning ids
</h3>
<p>
If you add [name_of_id], just after the marks that denote heading or list type items, it becomes the id attribute of resulting html elements. Below is an example.
</p>
<pre>
!![heading_id]heading

*[list_id]list
</pre>
<p>
will be rendered as
</p>
<pre>
&lt;div class=&quot;section h2&quot;&gt;
&lt;h2 id=&quot;HEADING_ID&quot;&gt;heading
&lt;/h2&gt;
&lt;ul&gt;
&lt;li id=&quot;LIST_ID&quot;&gt;list
&lt;/li&gt;
&lt;/ul&gt;
&lt;!-- end of section h2 --&gt;
&lt;/div&gt;
</pre>
<!-- end of section h3 -->
</div>
<div class="section h3">
<h3 id="ESCAPING_TAGS"> Escaping tags for inline decorations
</h3>
<p>
<em>(Please note that this is just an experimental feature.)</em>
</p>
<p>
Tags for inline decorations are escaped when they are enclosed in plugin tags:
</p>
<pre>
For example, {{''}} and {{==}} can be escaped.
And {{ {}} and {{} }} should be rendered as two left curly braces and two right curly braces respectively.
</pre>
<p>
will be rendered as
</p>
<pre>
For example, '' or == can be escaped.
And {{ and }} sould be rendered as two left curly braces and two right curly braces respectively.
</pre>
<!-- end of section h3 -->
</div>
<div class="section h3">
<h3 id="NESTING_LINK_TAGS"> Nesting of link tags
</h3>
<p>
If a link tag is nested inside another link tag, the outer tag is always treated as a link even when its url is for an image.
</p>
<p>
So you can make a link from a thumbnail as in the following example.
</p>
<pre>
[[[[thumbnail of an image|<a href="http://www.example.org/image_thumb.png">http://www.example.org/image_thumb.png</a>]]|<a href="http://www.example.org/image.png">http://www.example.org/image.png</a>]]
</pre>
<p>
will be rendered as
</p>
<pre>
&lt;a href=&quot;<a href="http://www.example.org/image.png&amp;quot;&amp;gt;&amp;lt;img">http://www.example.org/image.png&quot;&gt;&lt;img</a> alt=&quot;thumbnail of an image&quot; src=&quot;<a href="http://www.example.org/image_thumb.png&amp;quot;&amp;gt;">http://www.example.org/image_thumb.png&quot;&gt;</a>
&lt;/a&gt;
</pre>
<!-- end of section h3 -->
</div>
<div class="section h3">
<h3 id="EXPERIMENTAL"> Experimental
</h3>
<p>
The following features are just experimental and available only in <a href="https://github.com/nico-hn/PseudoHikiParser/tree/develop">develop branch</a>.
</p>
<div class="section h4">
<h4> Decorator for blocks
</h4>
<p>
By lines that begin with '//@', you can assign certain attributes to its succeeding block.
</p>
<p>
For example,
</p>
<pre>
//@class[class_name]
!!A section with a class name

paragraph
</pre>
<p>
will be rendered as
</p>
<pre>
&lt;div class=&quot;class_name&quot;&gt;
&lt;h2&gt;A section with a class name
&lt;/h2&gt;
&lt;p&gt;
paragraph
&lt;/p&gt;
&lt;!-- end of class_name --&gt;
&lt;/div&gt;
</pre>
<!-- end of section h4 -->
</div>
<div class="section h4">
<h4> Defining sections
</h4>
<p>
When a certain part of a document is enclosed by <code>//@begin[section_name]</code> and <code>//@end[section_name]</code>, HtmlFormat and its subclasses will convert the tags into &lt;div&gt; or &lt;section&gt; elements with id or class attributes.
</p>
<pre>
!! title

paragraph 0

//@begin[main-part]

!!! main part subtitle 1

paragraph 1

!!! main part subtitle 2

paragraph 2

//@end[main-part]

//@begin[additional-part]

!!! additional part subtitle

paragraph 3

//@end[additional-part]

</pre>
<p>
will be rendered as
</p>
<pre>
&lt;div class=&quot;section h2&quot;&gt;
&lt;h2&gt; title
&lt;/h2&gt;
&lt;p&gt;
paragraph 0
&lt;/p&gt;
&lt;div class=&quot;section main-part&quot;&gt;
&lt;div class=&quot;section h3&quot;&gt;
&lt;h3&gt; main part subtitle 1
&lt;/h3&gt;
&lt;p&gt;
paragraph 1
&lt;/p&gt;
&lt;!-- end of section h3 --&gt;
&lt;/div&gt;
&lt;div class=&quot;section h3&quot;&gt;
&lt;h3&gt; main part subtitle 2
&lt;/h3&gt;
&lt;p&gt;
paragraph 2
&lt;/p&gt;
&lt;!-- end of section h3 --&gt;
&lt;/div&gt;
&lt;!-- end of section main-part --&gt;
&lt;/div&gt;
&lt;div class=&quot;section additional-part&quot;&gt;
&lt;div class=&quot;section h3&quot;&gt;
&lt;h3&gt; additional part subtitle
&lt;/h3&gt;
&lt;p&gt;
paragraph 3
&lt;/p&gt;
&lt;!-- end of section h3 --&gt;
&lt;/div&gt;
&lt;!-- end of section additional-part --&gt;
&lt;/div&gt;
&lt;!-- end of section h2 --&gt;
&lt;/div&gt;
</pre>
<!-- end of section h4 -->
</div>
<!-- end of section h3 -->
</div>
<div class="section h3">
<h3 id="NOT_IMPLEMENTED"> Not Implemented Yet
</h3>
<!-- end of section h3 -->
</div>
<!-- end of section h2 -->
</div>
<div class="section h2">
<h2 id="VISITOR_CLASSES"> Visitor classes
</h2>
<p>
Please note that some of the following classes are implemented partly or not tested well.
</p>
<div class="section h3">
<h3 id="HTMLFORMATS"> <a href="https://github.com/nico-hn/PseudoHikiParser/blob/develop/lib/pseudohiki/htmlformat.rb#L8">HtmlFormat</a>, <a href="https://github.com/nico-hn/PseudoHikiParser/blob/develop/lib/pseudohiki/htmlformat.rb#L312">XhtmlFormat</a>
</h3>
<p>
Their class method (HtmlFormat|XhtmlFormat).format returns a tree of <a href="https://github.com/nico-hn/PseudoHikiParser/blob/develop/lib/htmlelement.rb">HtmlElement</a> objects, and you can traverse the tree as in the following example.
</p>
<pre>
#!/usr/bin/env ruby

require 'pseudohikiparser'

hiki_text = &lt;&lt;HIKI
!! heading

paragraph 1 that contains [[a link to a html file|<a href="http://www.example.org/example.html">http://www.example.org/example.html</a>]]

paragraph 2 that contains [[a link to a pdf file|<a href="http://www.example.org/example.pdf">http://www.example.org/example.pdf</a>]]
HIKI

html = HtmlFormat.format(hiki_text)

html.traverse do |elm|
  if elm.kind_of? HtmlElement and elm.tagname == &quot;a&quot;
    elm[&quot;class&quot;] = &quot;pdf&quot; if /\.pdf\Z/o =~ elm[&quot;href&quot;]
  end
end

puts html.to_s
</pre>
<p>
will print
</p>
<pre>
&lt;div class=&quot;section h2&quot;&gt;
&lt;h2&gt; heading
&lt;/h2&gt;
&lt;p&gt;
paragraph 1 that contains &lt;a href=&quot;<a href="http://www.example.org/example.html&amp;quot;&amp;gt;a">http://www.example.org/example.html&quot;&gt;a</a> link to a html file&lt;/a&gt;
&lt;/p&gt;
&lt;p&gt;
paragraph 2 that contains &lt;a class=&quot;pdf&quot; href=&quot;<a href="http://www.example.org/example.pdf&amp;quot;&amp;gt;a">http://www.example.org/example.pdf&quot;&gt;a</a> link to a pdf file&lt;/a&gt;
&lt;/p&gt;
&lt;!-- end of section h2 --&gt;
&lt;/div&gt;
</pre>
<!-- end of section h3 -->
</div>
<div class="section h3">
<h3 id="XHTML5FORMAT"> <a href="https://github.com/nico-hn/PseudoHikiParser/blob/develop/lib/pseudohiki/htmlformat.rb#L318">Xhtml5Format</a>
</h3>
<p>
This visitor is for HTML5.
</p>
<p>
Currently there aren't many differences with <a href="https://github.com/nico-hn/PseudoHikiParser/blob/develop/lib/pseudohiki/htmlformat.rb#L312">XhtmlFormat</a> except for the handling of &lt;section&gt; elements.
</p>
<!-- end of section h3 -->
</div>
<div class="section h3">
<h3 id="PLAINTEXTFORMAT"> <a href="https://github.com/nico-hn/PseudoHikiParser/blob/develop/lib/pseudohiki/plaintextformat.rb">PlainTextFormat</a>  
</h3>
<p>
This visitor removes markups from its input and returns plain texts. Below are examples
</p>
<pre>
:tel:03-xxxx-xxxx
::03-yyyy-yyyy
:fax:03-xxxx-xxxx
</pre>
<p>
will be rendered as
</p>
<pre>
tel:	03-xxxx-xxxx
	03-yyyy-yyyy
fax:	03-xxxx-xxxx
</pre>
<p>
And
</p>
<pre>
||cell 1-1||&gt;&gt;cell 1-2,3,4||cell 1-5
||cell 2-1||^&gt;cell 2-2,3 3-2,3||cell 2-4||cell 2-5
||cell 3-1||cell 3-4||cell 3-5
||cell 4-1||cell 4-2||cell 4-3||cell 4-4||cell 4-5
</pre>
<p>
will be rendered as
</p>
<pre>
cell 1-1	cell 1-2,3,4	==	==	cell 1-5
cell 2-1	cell 2-2,3 3-2,3	==	cell 2-4	cell 2-5
cell 3-1	||	||	cell 3-4	cell 3-5
cell 4-1	cell 4-2	cell 4-3	cell 4-4	cell 4-5
</pre>
<!-- end of section h3 -->
</div>
<div class="section h3">
<h3 id="MARKDOWNFORMAT"> <a href="https://github.com/nico-hn/PseudoHikiParser/blob/develop/lib/pseudohiki/markdownformat.rb">MarkDownFormat</a>
</h3>
<p>
This visitor is for (Git Flavored) Markdown and just in experimental stage.
</p>
<p>
The following are a sample script and its output:
</p>
<pre>
#!/usr/bin/env ruby

require 'pseudohiki/markdownformat'

md = PseudoHiki::MarkDownFormat.create
gfm = PseudoHiki::MarkDownFormat.create(gfm_style: true)

hiki = &lt;&lt;TEXT
!! The first heading

The first paragraph

||!header 1||!header 2
||''cell 1''||cell2

TEXT

tree = PseudoHiki::BlockParser.parse(hiki)
md_text = md.format(tree).to_s
gfm_text = gfm.format(tree).to_s
puts md_text
puts &quot;--------------------&quot;
puts gfm_text
</pre>
<p>
(You will get the following output.)
</p>
<pre>
## The first heading

The first paragraph

&lt;table&gt;
&lt;tr&gt;&lt;th&gt;header 1&lt;/th&gt;&lt;th&gt;header 2&lt;/th&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;em&gt;cell 1&lt;/em&gt;&lt;/td&gt;&lt;td&gt;cell2&lt;/td&gt;&lt;/tr&gt;
&lt;/table&gt;

--------------------
## The first heading

The first paragraph

|header 1|header 2|
|--------|--------|
|_cell 1_|cell2   |
</pre>
<div class="section h4">
<h4 id="MARKDOWN-LIMITATIONS">Limitations
</h4>
<p>
You can not convert malformed lists with this visitor class. That means list items must be nested hierarchically and if you skip a level in the sequence of items, the result of coversions will be corrupted.
</p>
<p>
The following is an example of malformed list in which the first level is skipped:
</p>
<pre>
**First item
**Second item
</pre>
<!-- end of section h4 -->
</div>
<!-- end of section h3 -->
</div>
<!-- end of section h2 -->
</div>
<!-- end of section h1 -->
</div>
</body>
</html>
